<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.group7.dao.AccountInfoDao">
    <!--&lt;!&ndash;配置文件加这个Redis&ndash;&gt;-->
    <cache type="org.mybatis.caches.redis.RedisCache" blocking="false"
           flushInterval="0" readOnly="true" size="1024" eviction="FIFO"/>
    <select id="accountInfo" resultType="map" parameterType="java.lang.String">
        select * from tb_useraccount where useraccountid =
          (select userinformationid from tb_userinformation where userinformationid =
            (select id from tb_user where username = #{userName}))
    </select>

    <select id="payPwd" resultType="int" parameterType="java.lang.String">
          select PAYPASSWORD from tb_userinformation where userid =(select id from tb_user where username = #{userName})
    </select>

    <update id="charge" parameterType="map">
        update tb_useraccount set ACCOUNMONEY=#{money} , AVAILMONEY=#{money} where userinformationid=#{userinformationid}
    </update>

    <select id="headPic" resultType="java.lang.String" parameterType="java.lang.String">
        select HEADPORTRAIT from tb_userinformation where USERID=(select ID from tb_user where username=#{userName})
    </select>

    <update id="addHeadPic" parameterType="map">
        update tb_userinformation set HEADPORTRAIT =#{imgName} where USERINFORMATIONID=#{userinformationid}
    </update>
</mapper>